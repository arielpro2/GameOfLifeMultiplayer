---

apiVersion: apps/v1

kind: Deployment

metadata:

  name: game-of-life-deployment

  labels:

    app: game-of-life

spec:

  replicas: 1

  selector:

    matchLabels:

      app: game-of-life

  template:

    metadata:

      labels:

        app: game-of-life

    spec:

      containers:

        - name: game-of-life

          image: ghcr.io/arielsho/game-of-life-multiplayer:latest

          ports:

            - containerPort: 8084

          env:

            - name: DB_HOST

              valueFrom:

                secretKeyRef:

                  name: mysecret

                  key: DB_HOST

                  optional: false

            - name: DB_USERNAME

              valueFrom:

                secretKeyRef:

                  name: mysecret

                  key: DB_USERNAME

                  optional: false

            - name: DB_PASSWORD

              valueFrom:

                secretKeyRef:

                  name: mysecret

                  key: DB_PASSWORD

                  optional: false

            - name: DB_PORT

              valueFrom:

                secretKeyRef:

                  name: mysecret

                  key: DB_PORT

                  optional: false

            - name: DB_NAME

              valueFrom:

                secretKeyRef:

                  name: mysecret

                  key: DB_NAME

                  optional: false

      imagePullSecrets:

        - name: github-container-registry